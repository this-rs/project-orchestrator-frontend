@import 'tailwindcss';
@plugin '@tailwindcss/typography';

/* ─── Design Tokens ───────────────────────────────────────────────────
 * Tailwind v4 @theme — generates utility classes (bg-surface-base, shadow-md…)
 * AND CSS custom properties (--color-surface-base, --shadow-md…).
 * Colors support opacity modifiers: bg-surface-raised/50 via color-mix().
 * ─────────────────────────────────────────────────────────────────── */
@theme {
  /* Surface system — 5 layers of depth */
  --color-surface-base: #0f1117;
  --color-surface-raised: #1a1d27;
  --color-surface-popover: #1e2130;
  --color-surface-overlay: #232733;
  --color-surface-highlight: #2a2e3d;

  /* Border system */
  --color-border-subtle: rgba(255, 255, 255, 0.06);
  --color-border-default: rgba(255, 255, 255, 0.1);
  --color-border-strong: rgba(255, 255, 255, 0.16);

  /* Dark theme shadows (override Tailwind defaults) */
  --shadow-sm: 0 1px 2px rgba(0, 0, 0, 0.3);
  --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.4);
  --shadow-lg: 0 8px 24px rgba(0, 0, 0, 0.5);
  --shadow-xl: 0 8px 30px rgba(0, 0, 0, 0.5);
}

:root {
  color-scheme: dark;

  /* Primary palette */
  --color-primary: #6366f1;
  --color-primary-hover: #4f46e5;
  --color-primary-light: #818cf8;
  --color-primary-muted: rgba(99, 102, 241, 0.15);

  /* Semantic colors */
  --color-success: #22c55e;
  --color-warning: #f59e0b;
  --color-error: #ef4444;
  --color-info: #3b82f6;

  /* Typography */
  --text-primary: #f1f5f9;
  --text-secondary: #94a3b8;
  --text-tertiary: #64748b;
  --text-muted: #475569;

  /* Transitions */
  --transition-fast: 150ms ease;
  --transition-normal: 200ms ease;
  --transition-slow: 300ms ease;
}

body {
  @apply min-h-screen antialiased;
  background-color: var(--color-surface-base);
  color: var(--text-primary);
}

/* Smooth scrolling */
html {
  scroll-behavior: smooth;
  background-color: var(--color-surface-base);
}

/*
 * Tauri desktop — rounded window corners
 *
 * The native macOS rounded corners plugin (enableModernWindowStyle) clips
 * the window content layer. For the rounded corner zones to show the
 * correct color, html + body must be TRANSPARENT so the NSWindow
 * backgroundColor (set in Rust show_main_window) shows through.
 *
 * The .tauri-window wrapper carries the actual app background color.
 */
html.tauri,
html.tauri body {
  background-color: transparent !important;
}

.tauri-window {
  overflow: hidden;
  overscroll-behavior: none;
  background-color: var(--color-surface-base);
}

/* Disable overscroll bounce (macOS rubber-band) in Tauri desktop */
html.tauri,
html.tauri body,
html.tauri * {
  overscroll-behavior: none;
}

/* Custom scrollbar for dark theme */
::-webkit-scrollbar { width: 6px; height: 6px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb {
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
}
::-webkit-scrollbar-thumb:hover { background: rgba(255, 255, 255, 0.2); }

/* Card lift hover effect */
.card-interactive {
  transition: transform var(--transition-fast), box-shadow var(--transition-fast);
}
.card-interactive:hover {
  transform: translateY(-1px);
  box-shadow: var(--shadow-md);
}

/* Chat markdown — code blocks */
.chat-markdown pre {
  background: rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.06);
  border-radius: 0.5rem;
  padding: 0.75rem 1rem;
  overflow-x: auto;
  margin: 0.75rem 0;
}
.chat-markdown pre code {
  background: transparent;
  padding: 0;
  font-size: 0.8rem;
  line-height: 1.6;
}
.chat-markdown :not(pre) > code {
  background: rgba(255, 255, 255, 0.08);
  border-radius: 0.25rem;
  padding: 0.15em 0.35em;
  font-size: 0.85em;
}
.chat-markdown table {
  border-collapse: collapse;
  width: 100%;
  margin: 0.75rem 0;
  font-size: 0.8rem;
}
.chat-markdown th,
.chat-markdown td {
  border: 1px solid rgba(255, 255, 255, 0.1);
  padding: 0.4rem 0.6rem;
}
.chat-markdown th {
  background: rgba(255, 255, 255, 0.04);
}

/* rehype-highlight token colors (dark theme) */
.hljs { color: #c9d1d9; }
.hljs-keyword, .hljs-selector-tag, .hljs-built_in { color: #ff7b72; }
.hljs-string, .hljs-attr { color: #a5d6ff; }
.hljs-comment, .hljs-quote { color: #8b949e; font-style: italic; }
.hljs-number, .hljs-literal { color: #79c0ff; }
.hljs-function .hljs-title, .hljs-title.function_ { color: #d2a8ff; }
.hljs-type, .hljs-title.class_ { color: #ffa657; }
.hljs-variable, .hljs-template-variable { color: #ffa657; }
.hljs-punctuation { color: #c9d1d9; }
.hljs-tag { color: #7ee787; }
.hljs-name { color: #7ee787; }
.hljs-attribute { color: #79c0ff; }
.hljs-symbol, .hljs-bullet { color: #ffa657; }
.hljs-addition { color: #aff5b4; background: rgba(46, 160, 67, 0.15); }
.hljs-deletion { color: #ffdcd7; background: rgba(248, 81, 73, 0.15); }

/* Dependency Graph — React Flow controls themed */
.dep-graph-controls {
  background: var(--color-surface-raised) !important;
  border-radius: 8px !important;
  border: 1px solid var(--color-border-default) !important;
  box-shadow: var(--shadow-md) !important;
}
.dep-graph-controls button {
  background: transparent !important;
  border-bottom: 1px solid var(--color-border-subtle) !important;
  color: var(--text-secondary) !important;
  transition: background var(--transition-fast), color var(--transition-fast);
}
.dep-graph-controls button:hover {
  background: var(--color-surface-highlight) !important;
  color: var(--color-primary-light) !important;
}
.dep-graph-controls button svg {
  fill: currentColor !important;
}
.dep-graph-controls button:last-child {
  border-bottom: none !important;
}

/* Toast animations */
@keyframes slideInRight {
  from { transform: translateX(100%); opacity: 0; }
  to { transform: translateX(0); opacity: 1; }
}
@keyframes fadeOut {
  from { opacity: 1; }
  to { opacity: 0; }
}
@keyframes shrinkWidth {
  from { width: 100%; }
  to { width: 0%; }
}
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(12px); }
  to { opacity: 1; transform: translateY(0); }
}
